<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>商城详情页</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link href="/public/static/index/css/iconfont/iconfont.css" rel="stylesheet"/>
    <link href="/public/static/index/css/common.css" rel="stylesheet"/>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="/public/static/index/css/goods-detail.css" rel="stylesheet"/>

    <script src="/public/static/index/js/jquery.js"></script>
    <link rel="stylesheet" href="/public/static/index/js/slick/slick.css"/>
    <script src="/public/static/index/js/slick/slick.min.js"></script>
    <script src="/public/static/index/js/global.js"></script>
   <!--  <script src="http://www.jq22.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="/public/static/index/js/main.js"></script> -->
</head>
<body>
    <!--头部-->
        <div class="topper">
            <div class="wrapper">
                <div class="left-bar">
                    <div class="back-home divider">
                        <em></em><a href="{:url('Index/index')}">商城首页</a>
                    </div>
                    <div class="item"><a href="">商家中心</a></div>
                </div>
                <div class="right-bar">
                    {if $user != ''}
                     <div class="item"><a href="javascript:;">{$user}<span class="txt-theme"></span></a></div>
                    <div class="logout divider"><a href="{:url('Details/tuichu')}">退出</a></div>
                    {else}
                        <div class="item"><a href="{:url('Login/index')}?id={$list.id}">登陆<span class="txt-theme"></span></a></div>
                    <div class="logout divider"><a href="{:url('Login/register')}">注册</a></div>
                    {/if}

                    <span class=""></span>
                    <div class="cart"><em></em><a href="{:url('GoodsCart/index')}">购物车</a></div>
                    <div class="order"><em></em><a href="{:url('Dingdan/dingdan')}">我的订单</a></div>
                    <div class="fav"><em></em><a href="{:url('Footprint/fav')}">我的收藏</a></div>
                    <!-- <div class="fav"><em></em><a href="{:url('Shou/index')}">我的收藏</a></div> -->
                    <div class="help"><em></em><a href="">帮助中心</a></div>
                </div>
            </div>
        </div>
        <div class="shop-header wrapper">
            <div class="logo">
                <a href="{:url('Index/index')}"><img src="/public/static/index/img/logo.png" alt="logo" /></a>
            </div>
            <div class="shop-meta">
                <span class="ico"></span>
                <div class="info">
                    <div class="name">女神屋女装</div>
                    <div class="meta">
                        [&nbsp;描述&nbsp;<span class="txt-warn">4.6</span>&ensp;质量&nbsp;<span class="txt-theme">4.8</span>&ensp;服务&nbsp;<span class="txt-theme">4.9</span>&ensp;发货&nbsp;<span class="txt-theme">4.8</span>&nbsp;]
                    </div>
                </div>
            </div>
            <div class="shop-schbox">
                <div class="layout">
                    <form action="{:url('Index/sou')}" method="post">
                        <input class="search-txt" placeholder="搜流行宝贝" name="shop" type="text">
                        <button class="search-btn site">搜全站</button>
                        <!-- <button class="search-btn shop">搜本店</button> -->
                        <!-- <div class="suggest-box">
                            <div class="item" data-title="上衣 短款 短袖">上衣 短款 短袖<div class="tags"><span>雪纺</span><span>蕾丝</span><span>一字领</span></div></div>
                        </div> -->
                    </form>
                </div>
            </div>
        </div>
        <div class="shop-nav-box">
            <div class="shop-nav wrapper">
                <div class="shop-nav-all">
                    <a href="">所有宝贝</a>
                    <div class="sublist">
                        <a href="">短袖T恤/吊带</a>
                        <a href="">连体裤</a>
                        <a href="">吊带</a>
                    </div>
                </div>
                <ul class="shop-nav-rec">
                    <li><a href="">首页</a></li>
                    <li><a href="">2016春夏新品</a></li>
                    <li><a href="">女鞋</a></li>
                    <li><a href="">童鞋</a></li>
                </ul>
            </div>
        </div>
    <!--头部-->

    <div class="wrapper">
        <div class="detail-top clearfix">
            <div class="detail-goods">
                <div class="detail-show">
                    <div class="origin-show">
                        <div class="zoomup"></div>
                        <img class="big-pic" src="/public/image/{$list.img}" alt="百搭清新花朵两件套连衣裙" />
                    </div>
                    <div class="thumb-show">
                        <span class="item"><img class="s-pic" src="/public/image/{$list.img}" bsrc="/public/image/{$list.img}" /></span>
                        {if !empty($img)}
                        {foreach $img as $v}
                        <span class="item">
                        <img class="s-pic" src="/public/img/{$v.picname}" bsrc="/public/img/{$v.picname}" />
                        </span>
                        {/foreach}
                        {/if}
                        <!-- <span class="item"><img class="s-pic" src="/public/static/index/uploads/5.jpg" bsrc="/public/static/index/uploads/5.jpg" /></span>
                        <span class="item"><img class="s-pic" src="/public/static/index/uploads/3.jpg" bsrc="/public/static/index/uploads/3.jpg" /></span>
                        <span class="item"><img class="s-pic" src="/public/static/index/uploads/3.jpg" bsrc="/public/static/index/uploads/3.jpg" /></span> -->
                    </div>
                    <div class="zoom-show">
                        <img src="/public/static/index/" alt="" />
                    </div>
                </div>
                <div class="detail-info">
                    <div class="item-title"><span id="gname">{$list.gname}</span></div>
                    <div class="item-price">


                        <span class="now" id="price">￥{$list.price}</span>
                        <!-- <span class="dft">￥69.00</span> -->



                        <span class="dft">￥{$list.price+100}</span>




                    </div>
                    <ul class="item-data clearfix">
                        <li class="col-4">销量<span class="txt-theme ml10">{$list.nums}</span></li>





                        <!-- <li class="col-4">好评率<span class="txt-theme ml10">0</span></li> -->

                        <!-- <li class="col-4">好评率<span class="txt-theme ml10">0</span></li> -->





                        <li class="col-4">好评率<span class="txt-theme ml10">99%</span></li>




                        <li class="col-4">收藏<span class="txt-theme ml10">{$list.clicknum}</span></li>
                    </ul>
                    <div class="sku-info">
                        <div class="prop">
                            <div class="dt">颜色：</div>
                            <div class="dd">
                                <ul class="chose-img">
                                    {foreach $color as $v}
                                    <li><input type="radio" class="color" name="color" value="{$v}">{$v}</li>
                                    {/foreach}
                                </ul>
                            </div>
                        </div>
                        <div class="prop">
                            <div class="dt">尺寸：</div>
                            <div class="dd">
                                <ul class="chose-common">
                                    {foreach $ma as $v}
                                    <li><input type="radio"  class="ma" name="ma" value="{$v}">{$v}</li>
                                    {/foreach}
                                </ul>
                            </div>
                        </div>
                        <div class="prop">
                            <div class="dt">数量：</div>
                            <div class="dd">
                                <div class="mod-numbox chose-num" data-max="30">
                                    <span class="count-minus"></span>
                                    <input class="count-input"  type="text" name="num" />
                                    <span class="count-plus"></span>
                                </div>

                               <!-- <span>（限购2件）</span> -->


                                <!-- <span>（限购2件）</span> -->

                                <span></span>




                                <div class="stock">(库存{$list.num}件)</div>
                            </div>
                        </div>
                    </div>
                    <div class="item-action">
                        <!-- <a href="{:url('Goumai/index')}" class="buy-now" id="goumai">立即购买</a>
                        <a href="{:url('GoodsCart/index')}" class="add-cart" id="cart"> -->

                        {if $user != ""}
                            <a class="buy-now" id="goumai" style="text-decoration: none;">立即购买</a>
                            <a class="add-cart" id="cart" style="text-decoration: none;">加入购物车</a>
                       
                        {else}
                            {if $list.num == "0"}
                            <button class="buy232">立即预约</button>
                            {else}
                            <a href="{:url('Login/index')}" class="buy-now">立即购买</a>
                            {/if}
                            <a href="{:url('Login/index')}" class="add-cart">加入购物车</a>
                        {/if}
                    </div>

                    <script type="text/javascript">
                        //获取颜色
                        $('.color').click(function(){
                            var color=$(this).val();
                            // alert(color);

                            $.ajax({
                                type:"post",    //提交方式
                                url:"{:url('GoodsCart/huoqu')}",    //提交地址
                                data:{color:color}, //要提交的数据
                                success:function(data){     //如果返回数据成功要做的处理
                                    console.log(data);
                                }
                            });
                        });
                        //获取尺码
                        $('.ma').click(function(){
                            var ma=$(this).val();
                            $.ajax({
                                type:"post",    //提交方式
                                url:"{:url('GoodsCart/huoqu1')}",    //提交地址
                                data:{ma:ma}, //要提交的数据
                                success:function(data){     //如果返回数据成功要做的处理
                                    console.log(data);
                                }
                            });
                        });
                        //加入购物车
                        $('#cart').click(function(){

                            var gid='{$list.id}';
                            var name="{$list.gname}";
                            var img='{$list.img}';
                            var price='{$list.price}';
                            var num=$('.count-input').val();

                            $.ajax({
                                type:"post",    //提交方式
                                url:"{:url('GoodsCart/cart1')}",    //提交地址
                                data:{gid:gid,name:name,img:img,price:price,num:num}, //要提交的数据
                                success:function(data){     //如果返回数据成功要做的处理
                                   // alert(data);
                                    if(data==1){
                                        alert('颜色不能为空');
                                        location='';
                                    }else if(data==2){
                                        alert('尺码不能为空');
                                        location='';
                                    }else if(data==3){
                                        alert('已加入，请勿重复添加');
                                        location='';
                                    }else if(data==4){
                                        alert('加入购物城成功');
                                        location='';
                                    }
                                }
                            });
                        });
                        //点击购买
                        $('#goumai').click(function(){

                            var gid='{$list.id}';
                            var name="{$list.gname}";
                            var img='{$list.img}';
                            var price='{$list.price}';
                            var num=$('.count-input').val();

                            $.ajax({
                                type:"post",    //提交方式
                                url:"{:url('Goumai/gou1')}",    //提交地址
                                data:{gid:gid,name:name,img:img,price:price,num:num}, //要提交的数据
                                success:function(data){     //如果返回数据成功要做的处理
                                   // alert(data);
                                    if(data==1){
                                        alert('颜色不能为空');
                                    }else if(data==2){
                                        alert('尺码不能为空');
                                    }else if(data==3){
                                
                                        location="{:url('Goumai/gou2')}";
                                    }
                                }
                            });
                        });

                        $('.buy232').click(function(){
                            alert('预约成功,届时将由短信方式通知您！');
                        });
                    </script>

                    <div class="item-extend">
                        <a href="javascript:;" id="aa" class="fav">收藏</a>
                        <a href="" class="share"><i class="iconfont icon-fenxiang"></i>分享</a>
                            <!-- {if $list.shou == "0"}
                                <a class="fav">收藏</a>
                            {else if}
                                <a class="fav">已收藏</a>
                            {/if} -->
                        <script>
                            $(".fav").click(function(){
                                var gid='{$list.id}';
                                // alert(gid);
                                $.ajax({
                                    type:"post",
                                    url:"{:url('Details/shou')}",
                                    data:{gid:gid},
                                    success:function(data){
                                        if (data == 1) {
                                            alert("请先登录");
                                        }else{
                                            if (data == 2) {
                                                $(".fav").css('color', '#337ab7');
                                                $(".fav").html("已收藏");
                                            }else if (data == 3) {
                                                $(".fav").css('color', '#337ab7');
                                                $(".fav").html("收藏");
                                            }else{
                                                alert(data);
                                            }
                                        }
                                    },
                                    error:function(data){
                                        alert("失败")
                                    }
                                });
                            });
                        </script>
                        <!-- {if $list.shou == "0"}
                            <a class="fav">点赞</a>
                        {else if}
                            <a class="fav">已点赞</a>
                        {/if}
                        <script>
                            $(".share").click(function(){
                                var gid='{$list.id}';
                                // alert(gid);
                                $.ajax({
                                    type:"post",
                                    url:"{:url('Details/zan')}",
                                    data:{gid:gid},
                                    success:function(data){
                                        if (data == 1) {
                                            alert("请先登录");
                                        }else{
                                            if (data == 2) {
                                                $(".share").html("已点赞");
                                            }else if (data == 3) {
                                                $(".share").html("点赞");
                                            }else{
                                                alert(data);
                                            }
                                        }
                                    },
                                    error:function(data){
                                        alert("失败")
                                    }
                                });
                            });
                        </script> -->

                    </div>
                </div>
            </div>
            <div class="detail-shop">
                <div class="clearfix">
                    <a class="shop-brand" href="">
                        <img src="/public/static/index/uploads/1.png" alt="" />
                    </a>
                    <div class="shop-intro">
                        <div class="shop-name">女神屋</div>
                        <!-- <a class="shop-follow-btn" href="javascript:;"><i class="iconfont icon-jiaguanzhu"></i>关注</a> -->
                        <a class="shop-follow-btn active" href="javascript:;"><span class="showtxt"><i class="iconfont icon-check01"></i>已关注</span><span class="hidetxt">取消关注</span></a>
                        <div class="shop-follow-count"><strong>268</strong>粉丝</div>
                    </div>
                </div>
                <div class="shop-assess clearfix">
                    <div class="col col-3">
                        <div class="tit">描&ensp;述</div>
                        <div class="point">
                            <span class="num">4.8</span><i class="iconfont">--</i>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="tit">质&ensp;量</div>
                        <div class="point up">
                            <span class="num">4.9</span><i class="iconfont">--</i>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="tit">服&ensp;务</div>
                        <div class="point down">
                            <span class="num">4.7</span><i class="iconfont">--</i>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="tit">发&ensp;货</div>
                        <div class="point">
                            <span class="num">4.8</span><i class="iconfont">--</i>
                        </div>
                    </div>
                </div>
                <ul class="shop-info">
                    <li>所在地区：广东广州</li>
                    <li>商品数量：518</li>
                    <li>销售数量：60285</li>
                    <li>店铺资质：<img class="ico" src="/public/static/index/img/ico/approve.png" alt="" /></li>
                </ul>
                <a class="detail-shop-enter">
                    <i class="iconfont icon-dianpu"></i>进入店铺
                </a>
            </div>
        </div>
        <!-- 商品推荐 -->
        <div class="ui-tabs">
            <span class="item active">店长推荐</span>
        </div>
        <ul class="detail-rec clearfix">
            {foreach $data as $v}
            <li>
                <a href="{:url('Details/index',['id'=>$v.id])}" class="figure"><img src="/public/image/{$v.img}" alt="" /></a>
                <div class="name"  style=" overflow:hidden;width: 188px;"><a href="">{$v.gname}</a></div>
                <div class="price">￥{$v.price}</div>
            </li>
            {/foreach}
        </ul>
        <!-- 商品推荐 -->

        <div class="detail-bottom clearfix">
             <div class="detail-main">
                <div class="detail-tabs">
                    <a class="item" href="javascript:;">详情描述</a>
                    <a class="item" href="javascript:;">规格参数</a>
                    <a class="item" href="javascript:;">商品评价</a>
                </div>
                <div class="tab-con">
                    <div class="mod-type-cont">
                        {$list.xiang|raw}
                        <!-- <img src="/public/static/index/uploads/10.jpg" alt="" /> -->
                    </div>
                </div>
                <div class="tab-con">
                    <div class="detail-stand">
                        <div class="tit">主体规格参数</div>
                        <div class="attr">
                            <div class="name">品牌</div>
                            <div class="value">Sacon帅康</div>
                        </div>
                        <div class="attr">
                            <div class="name">品牌</div>
                            <div class="value">Sacon帅康</div>
                        </div>
                        <div class="attr">
                            <div class="name">品牌</div>
                            <div class="value">Sacon帅康</div>
                        </div>
                        <div class="attr">
                            <div class="name">品牌</div>
                            <div class="value">Sacon帅康</div>
                        </div>
                        <div class="attr">
                            <div class="name">品牌</div>
                            <div class="value">Sacon帅康</div>
                        </div>
                    </div>
                </div>
                <div class="tab-con">
                    <div class="detail-pj">
                        <div class="detail-pj-nav list clearfix">
                            <div class="col col1">评价心得</div>
                            <div class="col col2">满意度</div>
                            <div class="col col3">商品信息</div>
                            <div class="col col4">评价用户</div>
                        </div>
                        <div class="detail-pj-cont">
                            {foreach $ping as $val}
                            {if $val.ggid==$list.id}
                            <div class="reply list clearfix">
                                <div class="col col1">{$val.content}<span class="time">{$val.addtime}</span></div>
                                <div class="col col2" style="color:red;">[{$val.haoping}]</div>
                                <div class="col col3">
                                尺码/色:{$val.xinghao}</div>
                                <div class="col col4"><div>{$val.user}</div></div>
                            </div>
                            {/if}
                            {/foreach}
                        </div>
                        <div class="pages mb30">
                            <a class="prev" href="">上一页</a>
                            <a href="">1</a>
                            <span>2</span>
                            <a href="">3</a>
                            <a href="">4</a>
                            <i>...</i>
                            <a href="">71</a>
                            <a class="next" href="">下一页</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="detail-aside">
                <div class="detail-aside-box mb15">
                    <div class="big-tit">商品分类</div>
                    <div class="detail-menu">
                        {foreach $one as $v}
                        <div class="item">
                            <div class="type" data-action="shopd-type"><span class="iconfont"></span>
                                <a href="javascript:;">{$v.name}</a>
                            </div>
                            
                            <ul class="c-type">
                                {foreach $two as $va}
                                {if $va.pid == $v.id}
                                <li><a href="{:url('SearchGoods/index',['id'=>$va.id])}">{$va.name}</a></li>
                                {/if}
                                {/foreach}
                            </ul>
                            
                        </div>
                        {/foreach}
                    </div>
                </div>

                <div class="detail-aside-box">
                    <div class="big-tit">店铺热销</div>
                    <ul class="detail-hot">
                        {foreach $data as $v}
                        <li>
                            <a href="" class="figure"><img src="/public//image/{$v.img}" alt="" /></a>
                            <div class="name"><a href="">{$v.gname}</a></div>
                            <div class="price">
                                <span class="now">¥{$v.price}</span><span class="origin">¥{$v.price+100}</span>
                            </div>
                        </li>
                        {/foreach}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!--脚部-->
    <div class="fatfooter">

    </div>
    <!--脚部-->
</body>

<script>
    /*商品数量操作*/
    function goodsCount(o){
            if(!(o instanceof Object)) var o={};
            var inputCell = o.inputCell || ".count-input",
                minusCell = o.minusCell || ".count-minus",
                plusCell = o.plusCell || ".count-plus",
                disClass = o.disClass || "disabled";
            return this.each(function(){
                var $wrap = $(this),
                    $input = $(inputCell,$wrap),
                    $minus = $(minusCell,$wrap),
                    $plus = $(plusCell,$wrap),
                    maxnum=parseInt($wrap.attr('data-max')) || false,
                    minnum=$wrap.attr('data-min') || 1,
                    initnum=$input.val() || minnum;
                /*初始*/
                $input.val(initnum);
                checkIlegal();
                function checkIlegal(){
                    var value =parseInt($input.val());

                    //
                     if (maxnum&&value>maxnum) {
                        $input.val(maxnum);
                    }
                    else if (value<minnum) {
                        $input.val(minnum);
                    }
                    if(value<=minnum){
                        $minus.addClass(disClass);
                    }else{
                        $minus.removeClass(disClass);
                    }
                    if (value>=maxnum) {
                        $plus.addClass(disClass);
                    }else {
                        $plus.removeClass(disClass);
                    }

                }
                function checknull() {
                    var value =$input.val();
                    if(value === "" || value === "0"){
                        $input.val(minnum);
                    }
                }
                $input.keyup(function(evt){
                    var value = $(this).val();
                    var newvalue = value.replace(/[^\d]/g,"");
                    $(this).val(newvalue);
                    checknull();
                });
                $input.blur(function(){
                    checknull();
                    checkIlegal();
                })

                $minus.click(function(){
                    minus();
                     checkIlegal();
                });

                $plus.click(function(){
                    add();
                    checkIlegal();
                });

                function add () {
                    var value = $input.val();
                    var plus = parseInt(value)+1;
                    $input.val(plus);
                }
                function minus () {
                    var value = parseInt($input.val());
                    var minus = value-1;
                    $input.val(minus);
                }
            });
        }
        $.fn.goodsCount = goodsCount;
</script>

<script >
    $(function () {

        +function () {
            var index=0,
            bsrc='',
            timer=null,
            box=$('.detail-show'),
            origin=$('.origin-show'),
            bigimg=box.find('.big-pic'),
            tumb=box.find('.thumb-show'),
            tumbItem=tumb.find('.item'),
            zoomup=box.find('.zoomup'),
            zoomshow=box.find('.zoom-show');

            /*图片切换*/
            tumbItem.on('mouseenter',function () {
                index=$(this).index();
                clearTimeout(timer);
                timer=setTimeout(function (){
                    update(index);
                }, 300)

            });

            function update (index) {
                bsrc=tumbItem.eq(index).find('.s-pic').attr('bsrc');
                bigimg.attr('src', bsrc);
                tumbItem.find('.s-pic').removeClass('active').end().eq(index).find('.s-pic').addClass('active');
            }

            update(index);

            if ($('.detail-show .thumb-show .item').length>5) {
                $('.detail-show .thumb-show').slick({
                    slidesToShow: 5,
                    infinite:false
                });
            }

            /*放大镜*/
            origin.on('mouseover mouseout',function (e) {
                if (e.type=="mouseover") {
                    var oX=$(this).offset().left,
                    oY=$(this).offset().top,
                    zX=e.pageX,
                    zY=e.pageY,
                    pW=$(this).outerWidth(),
                    pH=$(this).outerHeight(),
                    zW=zoomup.outerWidth(),
                    zH=zoomup.outerHeight(),
                    scale=pW/zW,
                    zsW=zoomshow.width()*scale,//放大后的宽度
                    factor=zsW/pW

                    zoomshow.find('img').attr('src',bigimg.attr('src')).width(zsW);

                    $(document).on('mousemove.zoom',function (e) {
                        zX=e.pageX-oX- zW/2;
                        zY=e.pageY-oY- zH/2;
                        move();
                    });

                    function move () {
                        zX=zX<=0?0:zX;
                        zX=zX>=pW-zW?pW-zW:zX;
                        zY=zY<=0?0:zY;
                        zY=zY>=pH-zH?pH-zH:zY;
                        zoomup.show().css({top:zY,left:zX});
                        zoomshow.show().find('img').css({top:-zY*factor,left:-zX*factor});
                    }
                }
                else {
                    $(document).off('mousemove.zoom');
                     zoomup.hide()
                     zoomshow.hide();
                }
            });
        }();

        $('.mod-numbox').goodsCount(); //数量加减

        $('.detail-main').zTab({
            tabnav:'.detail-tabs',
            trigger:'click'
        });
    });


    $("#aa").click(function(){
        var gname=$("#gname").html();
        var price=$("#price").html();
        // alert(gname);
        $.ajax({
            url:"{:url('Details/collection')}",
            type:"post",
            data:{gname:gname,price:price},
            success:function(data){
                if(data > 0){
                    alert("已收藏!");
                }
            }
        });
    });
</script>
</html>